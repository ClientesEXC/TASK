{"ast":null,"code":"import api from '../config/api';\n\n// Adaptadores entre API <-> UI\nexport const toUIProduct = p => ({\n  id: p.id,\n  name: p.name,\n  description: p.description || '',\n  price: Number(p.price),\n  stock: Number(p.stock_total),\n  availableStock: Number(p.stock_available),\n  image: p.image_url || null,\n  is_active: !!p.is_active,\n  version: Number(p.version),\n  created_at: p.created_at,\n  updated_at: p.updated_at\n});\nconst BASE = '/v1/products'; // OJO: api.js ya tiene /api\n\nexport async function listProducts({\n  q = '',\n  page = 1,\n  per_page = 12,\n  sort = 'created_at',\n  dir = 'desc',\n  is_active = true,\n  min_stock,\n  include_deleted = false\n} = {}) {\n  const {\n    data\n  } = await api.get(`${BASE}`, {\n    params: {\n      q,\n      page,\n      per_page,\n      sort,\n      dir,\n      is_active,\n      min_stock,\n      include_deleted\n    }\n  });\n  return {\n    items: data.data.map(toUIProduct),\n    meta: data.meta\n  };\n}\nexport async function getProduct(id) {\n  const res = await api.get(`${BASE}/${id}`);\n  const etag = res.headers.etag; // \"v{version}\"\n  return {\n    item: toUIProduct(res.data.data),\n    etag\n  };\n}\nexport async function createProduct(form) {\n  const body = {\n    name: form.name,\n    description: form.description || null,\n    price: Number(form.price),\n    stock_total: Number(form.stock),\n    image_url: form.image || null,\n    is_active: true\n  };\n  const {\n    data\n  } = await api.post(`${BASE}`, body);\n  return toUIProduct(data.data);\n}\nexport async function updateProduct(id, form, expectedVersion) {\n  const body = {\n    name: form.name,\n    description: form.description || null,\n    price: form.price !== '' ? Number(form.price) : undefined,\n    stock_total: form.stock !== '' ? Number(form.stock) : undefined,\n    image_url: form.image || null,\n    expected_version: expectedVersion // optimistic locking\n  };\n  const res = await api.patch(`${BASE}/${id}`, body);\n  const updated = toUIProduct(res.data.data);\n  const etag = res.headers.etag; // \"v{version}\"\n  return {\n    updated,\n    etag\n  };\n}\nexport async function deleteProduct(id) {\n  const {\n    data\n  } = await api.delete(`${BASE}/${id}`); // soft delete\n  return toUIProduct(data.data);\n}\nexport async function restoreProduct(id) {\n  const {\n    data\n  } = await api.post(`${BASE}/${id}/restore`);\n  return toUIProduct(data.data);\n}","map":{"version":3,"names":["api","toUIProduct","p","id","name","description","price","Number","stock","stock_total","availableStock","stock_available","image","image_url","is_active","version","created_at","updated_at","BASE","listProducts","q","page","per_page","sort","dir","min_stock","include_deleted","data","get","params","items","map","meta","getProduct","res","etag","headers","item","createProduct","form","body","post","updateProduct","expectedVersion","undefined","expected_version","patch","updated","deleteProduct","delete","restoreProduct"],"sources":["C:/Users/Silvia/WebstormProjects/TASK/task-manager/frontend/src/services/products.js"],"sourcesContent":["import api from '../config/api';\r\n\r\n// Adaptadores entre API <-> UI\r\nexport const toUIProduct = (p) => ({\r\n    id: p.id,\r\n    name: p.name,\r\n    description: p.description || '',\r\n    price: Number(p.price),\r\n    stock: Number(p.stock_total),\r\n    availableStock: Number(p.stock_available),\r\n    image: p.image_url || null,\r\n    is_active: !!p.is_active,\r\n    version: Number(p.version),\r\n    created_at: p.created_at,\r\n    updated_at: p.updated_at,\r\n});\r\n\r\nconst BASE = '/v1/products'; // OJO: api.js ya tiene /api\r\n\r\nexport async function listProducts({\r\n                                       q = '',\r\n                                       page = 1,\r\n                                       per_page = 12,\r\n                                       sort = 'created_at',\r\n                                       dir = 'desc',\r\n                                       is_active = true,\r\n                                       min_stock,\r\n                                       include_deleted = false,\r\n                                   } = {}) {\r\n    const { data } = await api.get(`${BASE}`, {\r\n        params: { q, page, per_page, sort, dir, is_active, min_stock, include_deleted },\r\n    });\r\n    return {\r\n        items: data.data.map(toUIProduct),\r\n        meta: data.meta,\r\n    };\r\n}\r\n\r\nexport async function getProduct(id) {\r\n    const res = await api.get(`${BASE}/${id}`);\r\n    const etag = res.headers.etag; // \"v{version}\"\r\n    return { item: toUIProduct(res.data.data), etag };\r\n}\r\n\r\nexport async function createProduct(form) {\r\n    const body = {\r\n        name: form.name,\r\n        description: form.description || null,\r\n        price: Number(form.price),\r\n        stock_total: Number(form.stock),\r\n        image_url: form.image || null,\r\n        is_active: true,\r\n    };\r\n    const { data } = await api.post(`${BASE}`, body);\r\n    return toUIProduct(data.data);\r\n}\r\n\r\nexport async function updateProduct(id, form, expectedVersion) {\r\n    const body = {\r\n        name: form.name,\r\n        description: form.description || null,\r\n        price: form.price !== '' ? Number(form.price) : undefined,\r\n        stock_total: form.stock !== '' ? Number(form.stock) : undefined,\r\n        image_url: form.image || null,\r\n        expected_version: expectedVersion, // optimistic locking\r\n    };\r\n    const res = await api.patch(`${BASE}/${id}`, body);\r\n    const updated = toUIProduct(res.data.data);\r\n    const etag = res.headers.etag; // \"v{version}\"\r\n    return { updated, etag };\r\n}\r\n\r\nexport async function deleteProduct(id) {\r\n    const { data } = await api.delete(`${BASE}/${id}`); // soft delete\r\n    return toUIProduct(data.data);\r\n}\r\n\r\nexport async function restoreProduct(id) {\r\n    const { data } = await api.post(`${BASE}/${id}/restore`);\r\n    return toUIProduct(data.data);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}